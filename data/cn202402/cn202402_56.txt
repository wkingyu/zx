生成式大模型承载网络架构与关键技术探索 唐 宏   等 热点专题
中兴通讯技术
2024  年 4 月    第 30 卷第  2 期   Apr . 2024    Vol . 30  No. 2广域互联场景需求将逐步增加 。但是 ，与数据中心内部大模
型流量相比 ，广域网承载了多种不同类型的业务 ，流量特征
复杂 。虽然流控和拥塞控制等机制使得 RDMA 在数据中心内
部实现了落地部署 ，但在复杂组网的广域环境下 ，RDMA 远
距离直连传输技术并不成熟 ，在现网中难于规模部署 。运维
人员需要根据不同的网络环境和流量模型进行 RDMA 参数设
计和调优 ，这将会面临运维利用率 、拥塞 、时延等一系列
挑战[6]。
相比之下 ，面向广域 RDMA 的确定性网络技术 （Det‐
Net）较 为 成 熟 ，成 为 近 期 研 究 热 点 。随 着 灵 活 以 太 网
（FlexE ） 、切片分组网 （SPN） 、时间敏感网络 （TSN） 、优先
级调度队列增强机制 、网络演算等各类确定性技术的不断涌
现，后续可通过延续优先级流控 （PFC）信号 、长距离拥塞
控制 、网络负载均衡等技术实现 RDMA 的长距离扩展 。
2.2 数据传输技术
在生成式大模型训练中 ，服务器之间需要频繁地进行大
量数据的传输和交换 。传统的传输控制协议 /互联网协议
（TCP/IP ）在数据传输的过程中需要在用户空间与内核空间
之间多次拷贝 ，降低了数据传输效率 。相比之下 ，RDMA 允
许应用程序直接访问远程节点的内存 ，不经过内核 ，具有高
吞吐 、低延迟 、无CPU 占用等优点 ，可提升模型训练效率 ，
更为适合生成式大模型训练 。RDMA 从1999 年诞生以来 ，
经过 20年的发展 ，技术逐
步从高大上的 HPC 领域走
向广阔的通用数据中心领
域，广泛应用于大模型训
练、高性能计算等场景 。
RDMA 主要包括 3种类
型协议 ：InfiniBand （简称
IB） 、基于以太网的 RDMA
（RoCE ）以及基于 TCP/IP 协
议栈的 RDMA （iWARP ） 。3
种协议都符合 RDMA 标准 ，
使用相同的上层接口 ，具
体如图 3所示 。
IB从链路层到传输层
定义了一套全新的层次架
构，是为高性能计算设计
的专用技术 。IB在部署时
需要专用设备 ，如IB专用
交换机 、IB专用网卡 、IB专用线缆等 ，无法与现有的以太网设备兼容 。相比于传统以
太网 ，IB具备高带宽 、低延迟的数据传输能力以及无损网
络的特征 ，可满足大型数据中心和超级计算中心对高性能网
络的需求 。但是 ，IB体系独立封闭 ，采购维护成本高昂 ，
现阶段主要被用于高性能计算领域 ，如超级计算机 、数据中
心和科学研究机构等 。
现网中部署着大量基于以太网的产品 。为了扩大 RDMA
的应用范围 ，IB行业协会 （IBTA ）组织定义了基于以太网
（Ethernet ）的RoCE 技术标准 ，允许在不依赖 IB专用硬件的
情况下使用 RDMA 。
RoCE 通过扩展以太网协议栈 ，使标准以太网设备支持
RDMA 操作 ，实现了高性能远程内存访问与以太网易用性和
广泛部署特点的结合 。现阶段 RoCE 有两个主要版本 ：Ro‐
CEv1和RoCEv 2。RoCE v 1发布于 2010 年，是基于以太网链
路层实现的 RDMA 协议 ，但由于它不支持路由 ，也没有拥塞
控制机制 ，难以在数据中心规模使用 。RoCEv 2版本是对
RoCEv 1版本的重大改进 ，它基于以太网的用户数据报协议
（UDP） 。RoCEv 2支持路由 ，并且定义了基于显式拥塞通知
（ECN）/拥塞通知报文 （CNP）的拥塞控制机制 。相同场景
下，RoCE 虽然较 IB性能有所降低 ，但是因其性价比更高 ，
目前已经在一些超大规模数据中心商用部署 。
iWARP 是国际互联网工程任务组 （IETF ）提出的基于
TCP 的RDMA 协议 。由于 TCP 是面向连接的可靠协议 ，这使
图3 远程直接内存访问协议IB：InfiniBand
IBTA ：IB行业协会
IEEE ：电气与电子工程师协会
IETF：互联网工程任务组IP：互联网协议
iWARP ：基于 TCP/IP 协议栈的 RDMA
RDMA：直接内存访问
RoCE ：基于以太网的 RDMATCP：传输控制协议
UDP：用户数据报协议蓝色内容由 IBTA 定义 绿色内容由 IEEE/IETF 定义
RDMA 应用/上层协议
RDMA 应用编程接口
RDOMA 软件栈软件 典型硬件
InfiniBand RoCE v 1 RoCE v 2 iWARP
InfiniBand 管理 Ethernet/IP 管理 Ethernet/IP 管理 Ethernet/IP 管理IB传输协议
IB网络层
IB链路层IB传输协议
IB网络层
Ethernet 链路层IB传输协议
UDP
IP
Ethernet 链路层iWARP 协议
TCP
IP
Ethernet 链路层
52