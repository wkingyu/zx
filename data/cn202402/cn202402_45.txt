基于存算一体集成芯片的大语言模型专用硬件架构 何斯琪  等 热点专题
中兴通讯技术
2024  年 4 月    第 30 卷第  2 期   Apr . 2024    Vol . 30  No. 2健性保证了功能的正确性和高效性 。
3.3 基于蝶形网络的稀疏提取拓扑
我们运用蝶形网络来提取压缩后的稠密权重所对应的输
入激活特征 。如图 7所示 ，红色的特征经过蝶形的拓扑网络
后，被路由至右侧 。这个蝶形网络基于传输管的实现 ，而传
输管的控制信号由解码器实时产生 。解码器逻辑接收稠密权重的比特掩码 ，然后生成控制比特以配置蝶形网络中数据分
发的路径 。解码机制主要包含两个操作 ，即前缀 pop计数和
左旋转补码 （LRCW ） 。前缀 pop计数扫描位掩码的序列 ，并
输出当前位置之前 1的总数 。LRCW 是一个标准的左旋转 ，
其唯一不同之处在于移位在任何时候都以补码形式表示 。通
过这样的操作 ，我们能够有效地处理比特掩码 ，从而实现对
蝶形网络的灵活配置和输入特征的提取 。
图8显示了采用 28 nm CMOS 工艺制造的芯片 ，该芯片
工作频率高达 320 MHz ，总功耗为 250.65 mW 。考虑到网络
稀疏性 ，该芯片峰值性能为 3.3 TOPS 。芯片面积 3.93 mm2，
面积效率为 0.85 TOPS/m2。该芯片在生成查询 、键和值矩阵
和整体注意力方面分别实现了高达 11.83/25.22 TOPS/W 的系
统能效 。上述轻量化 -存内压缩协同设计方案实现了稀疏网
络在存算一体硬件上的稠密映射 ，显著提高存储密度和计算
能效 。
4 结束语
针对十亿级以上规模的大模型网络应用场景 ，目前的
GPU/TPU+DRAM 分离计算架构难以满足不断增长的系数数
据传输带宽需求 。为了缓解这一问题 ，存算一体的解决方
案，特别是存边计算型的存储颗粒尤为重要 ，它们有望有效
提 高 带 宽 。DRAM 存 算 因 具 有 高 密 度 的 特 点 ，SRAM 和
RRAM 因其具有高能效特点而备受关注 。同时 ，存内压缩技
术的应用可以实现稀疏网络在存算一体硬件上的稠密映射 ，
从而同时提高存储密度和计算的能量效率 。因此 ，在未来的
解码器逻辑
LRCW （src=‘0011 ’ ， shift= 1）01010110
44332210位掩码
0 0 1 1
0 0 1 1PPi=PPi-1+Bit-Mas kiStep1： PP
Step2： LRCW
图6 稀疏 -密集计算流程
数据分配网络
F7F6F5F4F3F2F1F0
F6F7F5F4F2F1F0F3
F6F4F5F7F0F1F2F3
F0F3F5F7F6F4F2F1
图7 蝶形数据路由网络 LRCW ：左旋转补码                PP ：弹栈次数         WFWDWCWBWAW9W8W7W6W5W4W3W2W1W0
修剪库  1修剪库  WF-W8
稠密权重W6W4W2W1
W6W4W2W1
稠密权重稠密权重矩阵
修剪库  0
位掩码W7W6W5W4W3W2W1W0
0 1 01 0 1 1 0
F7F6F5F4F3F2F1F0
输入特征
F6F4F2F1
提取特征路径生成
41