基于存算一体集成芯片的大语言模型专用硬件架构 何斯琪  等 热点专题
中兴通讯技术
2024  年 4 月    第 30 卷第  2 期   Apr . 2024    Vol . 30  No. 2为时钟频率 ×2/存储深度 。近存计算架构中广泛使用的数据
流映射方法完全可以运用在存边计算架构中 ，权重在计算开
始前预先加载在 COMB 宏中 ，权重沿输入通道方向切块后 ，
可以展平存入 COMB 宏的不同列 。同时我们可以利用多个
COMB Marco 电路提高输出通道方向的并行度 ，完成空间并
行计算 。
2.3 存算一体技术分类
目前业界已有一些存储颗粒形态的存边计算商业实现方
案：海力士 （SK Hynix ）提出的 AiM 的每颗 DRAM 芯粒含有
0.5 GB的存储和 512 GFLOPS 的算力 ；三星提出的 LPDDR 5-
PIM （存内计算 ）颗粒的峰值算力可达 102.4 GFLOPS 。与
NPU 相比 ，该设计提升了 4.5倍的算力 ，并节省了 72%的功
耗。然而 ，高密度 DRAM 的工艺专用性强 ，与CMOS 逻辑制
造工艺的兼容性较差 ，且受制于读破坏和电荷泄漏 ，需要定
期刷新存储 。
传统嵌入式存储介质 SRAM 工艺下的微缩比例远远低于
逻辑微缩比例 。考虑到光刻极限 ，单芯片的最大 SRAM 在
100 MB量级 ，且难以发生剧变 。因此在过去 ，集成度一直
限制了 SRAM 存算一体的发展 。但随着 2.5D/3D堆叠技术的
发展 ，代工厂有望在 SRAM 上实现更高的集成密度 ，实现投
影面积上等效晶体管密度的提升 。如图 5所示 ，我们基于集
成扇出 （FanOut ）工艺 ，将4颗65 nm SRAM 存边计算芯粒集成为一体 ，实现了 SRAM 存边计算架构算力和存储容量的
显著提升 。对于超过 4颗芯粒集成的情况 ，映射方法尚需优
化以实现算力随着芯粒数量的线性增长 。除此之外 ，另一种
存储颗粒形态的存边计算实现方案是阻变存储器 （RRAM ） 。
RRAM 是一种能够通过改变二端器件的阻值来存储信息的技
术，具有与 CMOS 工艺兼容性高 、非易失 、低读取功耗等特
点。基于 1TnR 的RRAM 存储器阵列通过三维堆叠技术 ，能
够实现接近 DRAM 的高密度存储 。这一技术趋势为存算一体
提供了更为灵活和高效的解决方案 。
3 轻量化 -存内压缩的协同设计
3.1 稀疏网络在存算一体上的部署挑战
随着参数和算力需求的不断增加 ，大型模型网络的存算
一体架构的部署面临更多的挑战 。幸运的是 ，稀疏技术为这
一问题提供了一种软硬件协同设计的解决方案 。首先 ，通过
对大型模型网络的全连接层进行权重修剪 ，能够明显减少在
生成查询 、键和值矩阵时的参数存储需求 。其次 ，大型模型
网络所特有的注意力稀疏性进一步减少了自我注意机制的计
算和存储需求 。然而 ，在加速稀疏模型的存算一体架构中 ，
仍然存在一些问题 。传统的存算一体架构通常以一个交叉杆
的形式组织来支持阵列级的计算并行性 。在将非结构化剪枝
的权重矩阵映射到交叉杆时 ，存储单元仍然需要保留零值权
重，以维持计算的同步性 。相较之下 ，结构化剪枝技术与并
行处理更为兼容 ，但这会降低网络准确性 。为了应对这些挑
战，我们提出了一种存内稠密权重系数存储方案和基于蝶形
网络的存算一体稀疏提取的激活拓扑网络 。
3.2 存内稠密权重系数存储
图6展示了模型权重系数稀疏化和稠密存储方案的流
程。首先 ，权重向量被划分为不同的剪枝子组 ，每个子组具
有相同的大小 ，并按照预定义的稀疏度进行修剪 。为了确定
稀疏率和剪枝子组的大小 ，我们在 Enwik- 8和Text- 8任务上
使用 12层注意力模型 。在通过全局修剪对网络进行稀疏化
时，我们发现在剪枝子组大小为 32、修剪 3/4的权重时 ，网
络性能保持不变 。因此 ，我们将剪枝子组大小设置为 32，
稀疏率设置为 75%，以进行稀疏前馈计算 。随后 ，剪枝后的
权重被压缩为密集向量和用二进制编码表示的比特掩码 ，后
者可以指示稠密权重的原始位置 。最后 ，根据比特掩码的信
息，我们需要从原始输入中提取和路由那些未跳过的输入特
征。这一过程实现了对稀疏权重的有效处理 。最终的乘积是
通过将这两个稠密向量相乘得到的 。整个流程的顺序性和稳
 图5 四芯粒 2.5D集成 Fanout 封装[8]2.5D集成扇出式封装显微图四芯粒存边计算处理器
40