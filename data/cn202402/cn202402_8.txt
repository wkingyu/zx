智能算力核心基础系统软件的现状与展望 郑纬民  等 热点专题
中兴通讯技术
2024  年 4 月    第 30 卷第  2 期   Apr . 2024    Vol . 30  No. 2并行计算系统包括 DeepSpeed[17]、Megatron[16]等。这些系统主
要采用了 3种并行策略 （数据并行 、张量并行和流水线并
行） ，并通过它们的灵活组合提高了计算效率 。由于英伟达  
GPU 的高计算能力和其通过 nvlink[19]高速互连技术实现的高
通信能力 ，Megatron 等并行计算系统已经能够在英伟达平台
上对 GPT、Llama 等大模型实现较高的计算效率 。
针对中国软硬件的并行计算系统仍有进步空间 ，目前主
要面临两个问题 。首先是大模型计算的自动并行难度较大 ，
特别是在涉及 3D并行的复杂组合时 ，需要并行计算系统根
据硬件特性选择合适的并行策略组合 。目前 ，主流的自动并
行算法面向英伟达硬件特性设计 ；针对国产硬件的自动并行
算法有待提高 。另外一个问题是新并行策略的研究 。新兴模
型和场景 ，例如混合专家模型 、多模态大模型 、长序列处
理、基于人类反馈的强化学习等 ，为并行策略的设计带来了
新 的 挑 战 ，需 要 经 典 3D并 行 之 外 的 其 他 并 行 策 略 来
支持[20-21]。
综合而言 ，并行计算系统在处理 Transformer 类大模型的
计算任务上已经相对成熟 ，尤其在英伟达硬件上表现出色 。
然而 ，中国的并行计算系统在易用性和计算效率方面仍有提
升空间 ，需要研究面向国产平台的自动并行算法和新场景下
的并行策略 ，以满足不断发展的科研和工业需求 。
2.2 通信库
通信库提供了多卡间的通信能力 ，是实现并行计算的基
础组件 。大模型计算对通信库有 3点要求 ：易用 、高效 、鲁
棒。通信库需要根据大模型的训练与推理提供完备的通信模
式接口 ，降低上层使用者的使用难度 。通信库提供的通信模
式接口应该是高效的 ，在大规模集群进行大模型训练时 ，通
信往往成为瓶颈 ，同时通信库需要对大模型的通信模式 、底
层硬件拓扑做针对性的通信优化 。通信库也需要是鲁棒的 ，
在大模型训练与推理中 ，通信是频繁的 ，因此系统的鲁棒性
很大程度上取决于通信库的鲁棒性 。
在国际上 ，现有的大模型系统常用的通信库是英伟达的
NCCL[22]。它提供了常见的集合通信模式 ，也能在英伟达硬
件平台上实现不错的性能 ，因此受到多数大模型系统的青
睐；然而 ，NCCL 通信库在高效性以及鲁棒性上仍有改进空
间。国际上的知名公司也针对各硬件平台做出了针对性优
化，推出了自己的通信库 ：如微软的 MSCCL[23]、英特尔的
OneCCL[24]、AMD 的RCCL[25]、Meta 的Gloo[26]。
中国算力平台的通信库设计也处在活跃发展期 。阿里设
计了 ACCL[27]，华为设计了 HCCL[28]；清华大学的研究团队开
发了 “八卦炉 ”系统 ，在新一代神威超级计算机上探索了针对百万亿参数量大模型训练的通信库设计 。综合考虑上层应
用的计算负载 、底层硬件的性能特征 ， “八卦炉 ”系统实现
了中国国产平台上的高效通信 。
3 计算加速软件
算子库和 AI编译器在硬件上高性能实现了大模型所需
的基本操作 ，有效支撑了上述的编程框架 、并行计算系统等
软件 。算子库和 AI编译器是大模型训练和推理的基础设施 ，
对于提高计算效率 、降低计算能耗具有重要意义 。算子库为
模型的基本操作奠定了基础 ，而AI编译器通常为现有算子
库无法支持的计算负载生成代码 。
3.1 算子库
算子库使得深度学习算法中常用的函数及模型结构的实
现更加高效 。通过提高底层硬件的利用效率 ，优化模型计算
过程 ，算子库可以提高大模型的训练和推理效率 。不同平台
的算子库暴露了相似接口 ，为上层跨平台深度学习框架的构
建提供了便利 。
在国际上 ，最常用的硬件平台为英伟达 GPU 。英伟达公
司在研发高性能 GPU 的同时 ，也提供了 cutlass[29]、cuB‐
LAS[30]、cuDNN[31]等高性能 GPU 加速库 。这些算子库封装了
矩阵乘等常用算子 ，对上层深度学习框架隐藏了 Tensor Core
等硬件实现细节 ，使得各种深度学习框架均可在该平台上实
现较优的运行速度 。算子库中也提供了基于模板的底层 API
以简化自定义算子开发 。超微公司亦提供了 rocBLAS[32]、
hipDNN[33]等接口相似的面向超微 GPU 架构的算子库 。
由于近两年美国的芯片限令 ，中国正在探索硬件的国产
化，研发了一系列高性能人工智能芯片 。特别是在高性能计
算机方面 ，新一代的神威 、天河等超级计算机采用了中国国
产的处理器和加速器 。这些国产加速器均提供了高性能的算
子库 ，如申威架构的 swBLAS 、昇腾架构的 AOL[34]库等 。这
些架构为国产硬件与 TensorFlow 、PyTorch 等主流 AI框架的
兼容提供了基础保障 ，提升了国产硬件平台的易用性 。但由
于中国芯片的硬件架构与其他国家的 GPU 架构有较大差异 ，
不能完全复刻其他国家算子库的开发方式 ，因此需要使用与
国产硬件架构相匹配的算子开发方式以进一步提升算子库
性能 。
深度学习算子库在大模型的训练和推理中扮演着关键的
角色 ，通过优化底层计算过程 ，提高了模型性能和效率 。国
际上已有成熟的深度学习算子库 ，中国也在通过持续的研发
投入不断提升国产硬件的算子库性能 。
04