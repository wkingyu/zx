数据管理系统发展趋势与挑战 韩银俊  等 企业视界
中兴通讯技术
2023  年 8 月    第 29 卷第  4 期   Aug . 2023    Vol . 29  No. 4NameNode 启动速度非常缓慢 ，其全局锁处理机制大大限制
了并发访问能力 。湖仓元数据和计算层面临着 ACID 事务性
能提升 、高效并发更新及写入 、海量元数据管理 、查询优化
等方面的挑战[26-28]。
湖仓一体不仅仅在数据处理上将数据湖和数据仓库互相
打通 ，还实现了数据一体化 。通过整合大数据 、数据仓库 、
AI等技术 ，中兴通讯研发了新一代面向湖仓融合的数据管
理系统 DAIP 。DAIP 兼顾性能和成本效率 ，通过以表格式
Table Format 为代表的新技术 ，将数据湖和数据仓库功能融
合，实现一体化存储 ，形成一套基于统一元数据的数据服务
系统 ；结合云原生技术 ，采用存算分离架构 ，提供统一开放
的存储接口 ；对接多样的计算引擎 ，实现存储和计算灵活部
署，实现资源按需使用 。DAIP 能够有效简化企业的数据基
础设施架构 ，让数据管理的灵活性与成长性得到了统一 。
DAIP 架构 如图 4所示 ，其中虚线内功能模块表示中兴通讯
自主研发的功能或者在开源基础上实现的增强功能 。
DAIP 基于自研大容量分布式元数据持久化技术 ，突破
了原生 NameNode 元数据全内存架构的限制 ，纵向扩展了单
NameNode 节点的元数据容量 。目前 ，单个 NameNode 可支持
的文件数量达到百亿以上 ，与原生联邦横向扩展架构兼容 。
二者叠加可满足千亿级文件存储的需求 ，有效应对大容量湖
仓存储挑战 。在流处理场景下应用不断向数据湖表中数据插
入数据或者进行 merge 、update 等操作时 ，会产生大量的小文件 。过多的小文件会导致计算引擎的查询过程变慢 ，并且
会引起系统扩展性和稳定性问题 。DAIP 研发了数据湖治理
功能 ，支持压缩合并表文件 、物理老化和孤儿文件清理等 ，
实现了自动数据布局和优化 ，以保持文件访问最佳性能 ，将
查询运行时间和占用存储容量减少了 10%以上 。围绕大规
模元数据管理及查询优化技术进行创新和实践 ，DAIP 构建
了一个面向湖仓融合的低成本索引系统 ，为湖仓不同计算引
擎提供统一计算加速能力 。通过将元数据管理与数据管理同
等看待 ，以分布式方式管理和处理元数据 ，该系统可以存储
非常丰富的元数据并扩展到非常大的表 ，可同时嵌入到多个
计算引擎中 ，结合查询优化技术允许各个计算引擎直接跳过
无关文件 ，以提升实时数据分析及查询效率 。
湖仓一体技术仍在不断迭代发展 。中兴通讯新一代面向
湖仓融合的数据管理系统将以提升用户体验为目标 ，为湖仓
提供更大的容量 、更快的速度 、更好的稳定性 ，并构建智能
数仓 、流式数仓等外围生态 ，在数字经济建设中发挥更重要
的作用 。
2.5 数据要素可信流通
数据作为新型生产要素 ，是数字化 、智能化的基础 ，已
快速融入生产 、分配 、流通 、消费和服务等各环节 。如何保
证不同场景下数据要素安全可信流通 ，构建数据治理新体
系，是工业界与学术界研究的热点问题 。
▲图4 新一代面向湖仓融合的数据管理系统架构图VM：虚拟机 ACID ：原子性 、一致性 、隔离性 、持久性统一开发 统一调度 统一开放 统一运营 统一管理
数据湖 数据仓库
元数据采集 、管理
逻辑入湖
物理入湖
元数据更新任务管理
任务编排
任务调度Catalog 管理
离线目录
在线目录元数据视图 元数据安全
权限控制
数据脱敏
数据加密数据治理
小文件合并
物理老化
孤儿文件清理
数据布局索引管理
索引刷新
索引构建
索引存储
索引框架统一服务
统一计算
统一元数据
统一存储
统一基础
设施安全管理运维管理批处理引擎
Spark流处理引擎
Flink机器学习引擎
Tensorflow交互式查询引擎
Trino交互式分析引擎
EBASE-A
查询优化 （索引优化 、索引推荐 、混合扫描 、动态裁剪 、诱导谓词 、近似去重 、向量化…… ）
OpenAPI/Thrift 服务
辅助加速
物化视图
数据草图
缓存预取
……
湖仓数据组织格式 Tableformat （ACID 事务、数据版本控制 ）
结构化数据
B100对象存储……半结构化 /非结构化数据
分布式文件系统
云底座 TCF
裸金属 /物理机 /VM/ 公有云 /私有云 /混合云
OpenAPI ：开放应用程序编程接口
69