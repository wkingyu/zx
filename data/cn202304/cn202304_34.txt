算力网络资源协同调度探索与应用 彭开来  等 热点专题
中兴通讯技术
2023  年 8 月    第 29 卷第  4 期   Aug . 2023    Vol . 29  No. 4使用的相同种类应用感知的应用请求调度算法过程与部
署算法相似 。不同的是 ，其输出为集群调度的概率分布 。系
统依据概率选择请求调度的集群 。公式 （12）表示 ：资源调
度到集群 1的概率为 0.3，调度到集群 2的概率为 0.3，调度
到集群 3的概率为 0.4。
res={集群1：0.3，集群2：0.3，集群3：0.4} 。 （12）
3 算力网络动态扩缩容系统
算力网络动态扩缩容系统是算力网络协同调度中的核心
模块之一 ，对于算网应用的运行以及用户服务的处理起着至
关重要的作用[9]。如图 3所示 ，平台设计的动态扩缩容系统
由监控采集模块 、指标预测模块和扩缩规划模块 3部分组
成。动态扩缩容系统依托这些组件通过异步工作的方式实现
微服务的动态扩缩容过程 （增加 /减少微服务实例 ） ，以实现
算力资源的弹性灵活调度 。
3.1 监控采集模块
算网应用进行动态扩缩容操作时 ，需要综合考虑内存使
用、CPU 使用情况 、系统的磁盘利用率 、系统网络带宽利用
率等负载指标 。这些负载指标所占的权重 （权重的和是 1）
根据具体情况而定 。定义系统的综合负载为 L，从算网资源
状况中获取 CPU 的使用情况为 C，内存使用情况为 M，磁盘
使用情况为 D，网络带宽使用情况为 B，它们的权重分别定
义为 ωC、ωM、ωD、ωB，其中 C, M, D, B∈[0,1]，则系统的综
合负载情况为 ：
L=ωCC+ωMM+ωDD+ωBB ， （13）
ωC+ωM+ωD+ωB=1 。 （14）
监控采集模块负责对整个算力网络的状态进行实时监
控。本算法主要考虑两类资源指标 ：一类是系统资源级别指标，另一类是自定义资源指标 。其中 ，自定义指标是指引入
三方监控提供 “业务 ”指标类型 。目前 ，三方监控主要有
Prometheus 、Microsoft Azure 和Datadog Cluster 等。指标适配
器将指标聚合到 Aggregator ，由 Aggregator 向指标预测模块以
及扩缩规划模块提供所需指标 。
3.2 指标预测模块
指标预测模块一方面抓取上述监控采集模块监控到的微
服务副本集的历史资源负载指标数据 ，并通过这些历史监控
数据和预测模型来对下一时刻的微服务副本集的资源负载值
进行预测 ；另一方面将资源负载预测值输出到扩缩规划模
块，以指导后续微服务的弹性扩缩容工作 。
随着系统的运行 ，时序性的负载指标也就产生了 。这些
负载指标由当前运行的 CPU、内存 、磁盘利用率和带宽占用
情况共同组成 。基于这些负载指标数据 ，系统可以预测出未
来某段时间的系统负载情况 ，并根据预测的未来负载来进行
资源的弹性伸缩 。该问题可以看作一个时序预测问题 。预测
模块的输入为之前一段时间 （扩缩容周期或自定义 ）综合负
载率组成的一组时序数据 ；预测模块的输出为短期的未来时
序数据 。
当采用灰色预测模型对算网应用微服务的系统负载进行
预测时 ，指标预测模块得到的结果为一个时序序列 ，它表示
未来一段时间可能的资源使用量 。预测序列中的最大值表示
未来 n秒内微服务可能达到的资源使用量的最大值 ，作为主
要指标传递给扩缩规划模块 ，从而进行下一步规划 。
3.3 扩缩规划模块
在算力网络动态扩缩容系统中 ，扩缩规划模块拟采用
阶梯扩缩容的方式进行扩缩操作 。该扩缩规划模块通过指
标预测模块对资源负载未来的趋势进行分析 ，输出系统综
合负载率预测序列最大值 。如果该值大于扩容阈值 ，则扩
缩规划模块计算副本数 ×扩容步长 ，
并选取副本数 ×扩容步长与副本数
最大值之间的较大值 ，执行扩容命
令，使资源的副本数变多 ；如果小
于缩容阈值 ，则计算副本数 ×缩容
步长 ，选取副本数 ×缩容步长与副
本数最小值之间的较小值 ，执行缩
容命令 ，使资源的副本数变少 。因
此，算力网络动态扩缩容系统可以
提前做出扩容或缩容操作 ，以实现
算力资源的弹性扩缩 ，便于算力网 图3 算力网络动态扩缩容系统总体架构图监控采集模块
算网资源状况监控
系统综合负载情况计算指标预算模块
负载数据检验与处理
建立灰色预测模型
预测未来 n秒系统负载扩缩规划模块
扩缩容阈值判断
扩缩容步长规划
输出扩缩容决策扩缩规划模块
系统负载
情况预测序列
最值
30