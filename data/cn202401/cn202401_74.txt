超大规模天线阵列下的多用户快速波束训练 司 源  等 热点专题
中兴通讯技术
2024  年 2 月    第 30 卷第  1 期   Feb . 2024    Vol . 30  No. 1佳波束 ，若第m次训练中包含第 n个DFT 波束 ，则将第m次
训练的接收功率 ym累加到 DFT 波束n的测量结果 pn中；若
DFT 波束在某一轮训练中未被选中 ，则这一轮训练的接收功
率不计入该 DFT 波束的测量结果 。第n个DFT 波束的测量结
果可以表示为 ：
pn=∑
m=1M
cm，nym。 （5）
最后 ，用户选择测量结果最大的 DFT 波束fn̂用于数据传
输，其中n̂=argmax
npn。
许多已有波束训练方案均可视作哈希波束训练的特例 ，
这些方案的差异仅在于采用的哈希码本 。例如 ，传统轮询式
波束训练方案对应 M=N、L=1、C=I；文献 [19]的分层波
束训练方案对应 M=2log2N、L=N/2的哈希码本 。因此 ，
哈希码本设计对训练开销以及波束对齐性能有着重要影响 。
2 哈希码本设计
本节在文献 [17]完全随机哈希码本的基础上 ，提出部分
随机和固定两种改进的码本设计方法 。在设计哈希码本时 ，
完全随机方案中训练波束独立的选择 DFT 波束 ，对于有限的
波束训练次数 M，各个 DFT 波束被选中次数 Gn=∑m=1Mcm,n
差异较大 。当用户位于不同位置时 ，各个 DFT 波束被成功选
中的概率存在较大差异 ，导致整体波束对齐性能下降 。
2.1 所提随机哈希码本
针对完全随机哈希码本存在的问题 ，所提随机哈希码本
各个训练波束通过协作方式选择 DFT 波束 ，目标是使各个
DFT 波束出现次数 Gn相等 。为了实现这个目标 ，我们限制
码本参数 L能够整除 N，同时N/L能够整除 M。将训练波束
分为ML/N组，每组包含 N/L个训练波束 。同一组训练波束
通过不放回抽样的方式随机选择 DFT 波束 ，每个 DFT 波束
在一个训练波束组内只出现一次 ，从而有Gn=ML/N,∀n。具
体生成哈希码本 C的过程如算法 1所示 。
算法算法 11：：所提随机哈希码本设计
输入输入 ：：DFT 波束数 N，训练波束数 M，码本生成参数 L
1： 初始化 C=0M×N
2： forfor m=1，2，…，M
3：   ifif mod(m-1，N/L)==0，thenthen S={1，2，…，N}
4：   从集合S中随机选择 L个元素构成集合 T=
{n1，n2，…，nL}，
5：   cm，ni=1，1≤i≤L，S=S-T6： end forend for
输出输出 ：：所提随机哈希码本 C
2.2 固定哈希码本
对于系统实现而言 ，采用随机方式生成的哈希码本会导
致复杂度增加 。例如 ，基站和用户需要预先配置相同的随机
种子用于码本生成 。为此 ，本小节给出一种固定哈希码本设
计方法 。由于实际应用中码本是预先确定的 ，因此可以采用
离线仿真方式搜索波束训练性能最优的码本 。具体来说 ，研
究根据实际场景确定用户分布 ，得到信道样本 ；采用 3.1小
节中的方法生成 X个所提随机哈希码本 {C1,C2,⋯,CX}；随后
对这X个哈希码本在相同信道样本下进行蒙特卡洛仿真 ，并
选择波束对齐性能最优的作为固定哈希码本 。与随机生成的
哈希码本相比 ，所提固定哈希码本不仅便于系统实现 ，还能
够更好地匹配实际环境 。
3 波束对齐性能理论分析
本节从理论角度分析哈希码本对波束对齐成功概率的影
响，为了分析方便 ，假设信道仅包含视距 （LoS）成分 ，即
P=1。对于高频信道来说这一假设是合理的 ，因为非视距
（NLoS ）路径增益远远小于 LoS径，对接收功率影响较小 。
此外 ，不失一般性 ，我们假设增益 α=1。
3.1 波束对齐成功概率的准确表示
将最佳 DFT 波束下标记作 n*，波束对齐成功概率可以
表示为 ：
P{n*=n̂}=Pìíî∩
n'≠n*()pn*>pn'üýþ。 （6）
根据上式 ，我们重点分析事件 pn*>pn'的概率 。对于
LoS信 道h=a(θ)，仅 当θ位 于 DFT 波 束 覆 盖 范 围 内 时 ，
|hHfn|2具有较大取值 。为了简化推导 ，进一步假设 θ位于离
散 格 点 上 ，即sinθ=-1+2n/N,n=1,2,⋯,N，此 时 有
n*=n，|hHwm|2=cm,n*/L，结合公式 （4）和公式 （5）有：
pn*=Gn*
L+∑
m=1M
cm，n*nm， （7）
pn'=Kn*，n'
L+∑
m=1M
cm，n'nm，∀n'≠n*， （8）
其中Kn*,n'=∑m=1Mcm,n*cm,n'表示 DFT 波束n*和n'同时被训练
波束选中的次数 。根据公式 （7）和公式 （8） ，有：
70