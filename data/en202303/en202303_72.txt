ZTE COMMUNICATIONS
September  2023  Vol.21 No.3JI Yuhe , HAN Jing , ZHAO Yongxin , ZHANG Shenglin , GONG Zican Research Papers   Log Anomaly Detection Through GPT -2 for Large Scale Systems
Log Anomaly Detection Through GPTLog Anomaly Detection Through GPT --22 for  for 
Large Scale SystemsLarge Scale Systems
JI Yuhe1, HAN Jing2, ZHAO Yongxin1, 
ZHANG Shenglin1, GONG Zican2
(1. Nankai University , Tianjin 300071 , China；
 2. ZTE Corporation , Shenzhen 518057 , China )DOI: 10.12142 /ZTECOM .202303010
https ://kns .cnki.net/kcms/detail/ 34.1294 .TN.20230802 .1731 .004.html, 
published online August 3, 2023
Manuscript received : 2022 -12-08
Abstract : As the scale of software systems expands , maintaining their stable operation has become an extraordinary challenge . System logs are 
semi -structured text generated by the recording function in the source code and have important research significance in software service anomaly 
detection . Existing log anomaly detection methods mainly focus on the statistical characteristics of logs , making it difficult to distinguish the se ‐
mantic differences between normal and abnormal logs , and performing poorly on real -world industrial log data . In this paper , we propose an unsu ‐
pervised framework for log anomaly detection based on generative pre -training -2 (GPT -2). We apply our approach to two industrial systems . The 
experimental results on two datasets show that our approach outperforms state -of-the-art approaches for log anomaly detection .
Keywords : hybrid beamforming ; hybrid architecture ; weighted mean square error ; manifold optimization ; dynamic subarrays
Citation  (Format 1): JI Y H , HAN J , ZHAO Y X , et al . Log anomaly detection through GPT -2 for large scale systems [J]. ZTE Communications , 
2023 , 21(3): 70–76. DOI : 10.12142 /ZTECOM .202303010
Citation  (Format 2): Y. H. Ji, J. Han , Y. X. Zhao , et al ., “Log anomaly detection through GPT -2 for large scale systems ,” ZTE Communications , 
vol. 21, no. 3, pp. 70–76, Sept . 2023 . doi: 10.12142 /ZTECOM .202303010 .
1 Introduction
As the scale of software systems expands , maintaining 
their stable operation has become an extraordinary 
challenge . System logs are the text generated in the 
process of software running , which records the status 
information of the program[1–2]. Traditional log anomaly detec ‐
tion relies on manual analysis by operation engineers . The in ‐
crease in software systems leads to a surge in a log volume , 
manual analysis of logs and the design of regular expressions 
can consume considerable time , and the traditional log analy ‐
sis is no longer feasible . In recent years , researchers have pro ‐
posed a variety of automated log anomaly detection meth ‐
ods[3–8]. Early research on log exceptions focused on auto ‐
matic exception rule generation and simple statistical meth ‐
ods[9]. Then , researchers divided log analyses into three direc ‐
tions : template extraction , model training , and anomaly detec ‐
tion. In recent years , many intelligent log analysis methods 
have been proposed with the rapid development of machine 
learning , especially deep neural networks . For example , mod ‐
els based on convolutional neural networks (CNN ) and recur ‐
rent neural networks (RNN ) can effectively capture the se ‐
quence characteristics and frequency characteristics of log 
text, and apply them to the detection of new logs[3–5]. How ‐
ever, the application of the deep learning model in practical 
scenarios faces the following challenges :1) The normal pattern of logs is difficult to model . Most ex ‐
isting methods try to learn the normal pattern of log sequence 
and frequency . The team ’s O&M engineers pointed out that 
the semantics of logs in real -world scenarios are of consider ‐
able analytical importance . Since the production environment 
for generating and recording logs is not ideal , relying solely on 
sequence as well as frequency to encode logs can lead to a 
large number of false positives .
2) Complex log data contains massive noise . Due to the high 
concurrency of the software system and the uncertainty of net ‐
work response , the log generated can be disordered and con ‐
tain lots of noise .
To tackle the limitations of existing methods , in this paper , we 
propose an efficient and robust framework for log anomaly detec ‐
tion based on generative pre -training -2 (GPT -2)[10]. Inspired by 
the excellent performance of GPT -2 in serialization text genera ‐
tion and multiple types of downstream task processing , we lever ‐
age this model to capture patterns of normal log sequences .
The main contributions of this paper can be summarized as 
follows :
1) To tackle the first challenge , we generate sentence vec ‐
tors for each log template to represent their semantic informa ‐
tion. Specifically , we first apply Siamese Bidirectional En ‐
coder Representations from Transformers (SBERT ) networks 
to generate sentence vectors for all log templates and then in ‐
70