ZTE COMMUNICATIONS
September  2023  Vol.21 No.3TANG Yuanqi , ZHANG Huimin , ZHENG Zheng , LI Ping , ZHU Yu Research Papers   Hybrid Architecture and Beamforming Optimization for Millimeter Wave Systems
3.2 Receiver Design
With the fixed hybrid precoder , we can get the optimiza ‐
tion problem for the hybrid combiner . By differentiating Eq . 
(7) with respect to WBB,k, the closed -form solution of WBB,k is 
given by :
WBB,k=(WH
RFG͂
kG͂H
kWRF+ξ͂
kWH
RFWRF)-1
WH
RFG͂
k, (15)
where G͂
k=β-1
kHkFk, ξ͂
k=σ2
kβ-2
k. By substituting Eq . (15) 
back into Eq . (7), we can get the optimization problem of WRF 
as follows :
minimize
WRFg()WRF=
1
N∑
k=1N
tr ( )Tk( )INs+ξ͂-1
k G͂H
kWRF()WH
RFWRF-1WH
RFG͂
k-1
subject to|
||||| |
|||||[]WRFij=ì
í
îïï
ïïïï1, i, j∈{ } i, j||[]Ucij|=1
0, else.
(16)
This problem is difficult to tackle due to the non -convex 
constraint . However , since it has a similar form to the design 
problem of the analog precoder in Eq . (11), we can also adopt 
the MO method to optimize the analog combiner in the same 
way as we optimize the analog precoder . Firstly , the key step 
is to derive the Euclidean gradient of g(WRF) with the FC ar ‐
chitecture , which is given by :
g(WRF)=1
N∑
k=1N
ξ͂
k(WRF(WH
RFWRF)-1WH
RF-
    INr)G͂
kTkJ-2
kG͂H
kWRF(WH
RFWRF)-1,(17)
where Jk=Tk(INs+ξ͂
kG͂H
kWRF(WH
RFWRF)WH
RFG͂
k). Secondly , 
we can use the formula ∇g(WRF)=∇WFC
RFg(WRF)⊙Uc to ob ‐
tain the Euclidean gradient of g(WRF) with any specified ar ‐
chitecture . Finally , with the derived gradient , we can optimize 
WRF by applying a procedure similar to that in Algorithm 1.
3.3 Alternating Optimization
We develop a joint hybrid precoding and combining opti ‐
mization algorithm based on the WMMSE criterion by itera ‐
tively and alternatively using Algorithm 1. During each it ‐
eration , with the fixed hybrid combiner Wk and the weight 
matrix Tk, we first optimize FRF,FBB,k according to Algorithm 
1. Then , with the fixed hybrid precoder , we optimize 
WRF,WBB,k. Finally , we update Tk according to Eq . (8). These 
steps are repeated until the stopping condition is satisfied . 
The stopping condition could be set as a maximum number 
of iterations or it depends on whether the relative difference 
between the objective function values of two consecutive it ‐
erations is smaller than a specific value . The HBF algo ‐
rithm with a fixed hybrid architecture is summarized in Al ‐gorithm 2, which is referred to as the hybrid beamforming 
algorithm using manifold optimization under the WMMSE 
criterion (HBF -WMO algorithm ).
Algorithm 2: The HBF -WMO algorithm
  Input : σk,Hk,∀k∈{1,⋯,N},Up,Uc
   1: Initialize WRF,0,FRF,0,Tk,0,WBB,k,0,i=0
   2: repeat :
       3:  Compute FRF,i according to Algorithm 1
       4:  Compute βk,i,FU,k,i according to Eqs . (9) and (10)
       5:  Compute WRF,i according to Algorithm 1
       6:  Compute WBB,k,i according to Eq . (15)
       7:  Compute Tk,i=E-1
k,i
       8:  i←i+1
   9: until  a stopping condition is satisfied
   10: FBB,k=βkFU,k
  Output : FRF, FBB, k, WRF, WBB, k
4 Subarray Partition Optimization with the 
PC -Dynamic Architecture
In this section , we propose an algorithm to dynamically allo ‐
cate antennas to each RF chain through a switch network in 
accordance with the channel state variation , and under the 
constraint that each antenna element is allocated only once . 
Since the size of the receive antenna array is relatively small 
compared with that of the transmitter , we only consider the ar ‐
chitecture optimization of the transmitter here . Based on the 
derived objective function in Eq . (11), the WMMSE problem 
for the optimization of the subarray partition with the PC -
dynamic architecture is given by
minimize
FFC
RF,Upf()FFC
RF⊙Up
subject to |
||||| |
|||||[]FFC
RFij=1;
 []Upij∈{0,1};
()Upi∙1=1,∀i,j,(18)
where Upi∙ dedicates the i-th row of Up. The original problem is 
difficult to solve directly , so we transform it into a more trac ‐
table one . First , let Sr denote the antenna subset connected to 
the r-th RF chain . We partition Nt antennas into Nt
RF subsets as :
⋃Nt
RF
r=1 Sr=Sant,|Sr|>0,Si∩Sj=∅,∀i,j∈{1,⋯,Nt
RF},i≠j,
(19)
where |Sr| dedicates the number of elements in Sr and Sant=
{1,⋯,Nt}. The optimization problem can be formulated as :
98